<figure>

    <picture>

        {% if include.avif %}

        {% assign webp_filename = include.url | replace: ".jpg", ".avif" | replace: ".jpeg", ".avif" | replace: ".png", ".avif" | replace: ".tif", ".avif" %}

        {% else %}

        {% assign webp_filename = include.url | replace: ".jpg", ".webp" | replace: ".jpeg", ".webp" | replace: ".png", ".webp" | replace: ".tif", ".webp" %}

        {% endif %}

        <source srcset='{% unless jekyll.environment == "development" %}{{ site.url }}{% endunless %}/images/{{ webp_filename }}' type="image/webp">

        <img src='{% unless jekyll.environment == "development" %}{{ site.url }}{% endunless %}/images/{{ include.url }}' alt="{{ include.alt }}"{% unless include.not-lazy %} loading="lazy"{% endunless %}{% if include.height %} height="{{ include.height }}"{% endif %}{% if include.width %} width="{{ include.width }}"{% endif %}>

    </picture>

    <figcaption>

        <p>{{ include.caption }}</p>

    </figcaption>

</figure>
