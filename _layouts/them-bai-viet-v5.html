<html>

<head>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
   <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css'>
   <meta charset="utf-8">
   <title>Thêm bài viết mới v2</title>

</head>

<body>
   <hr>
   <hr>
   <div>
      <section class="grid extended-grid-18">
         <div class="container clearfix">
            <div class="row row-sm-sm sample-row">
               <div class="col-xs-12 col-md-8 gutter-sm-sm gutter-margin-xs-sm">
                  <div class="inner">
                     <form id="contact-form" class="form-horizontal" role="form">

                        <div class="form-group">
                           <div class="col-sm-12">
                              <input type="text" class="form-control" id="titleId" placeholder="Tiêu đề" name="Tiêu đề" value=""
                                 onkeydown="checkInputTitleId(this);" required>
                           </div>
                        </div>

                        <div class="form-group">
                           <div class="col-sm-12">
                              <input type="text" class="form-control" id="authorId"
                                 onkeydown="checkInputAuthorId(this);" placeholder="Tác giả" name="author-name" value=""
                                 required>
                           </div>
                        </div>

                        <textarea class="form-control"  id="editor" rows="10" placeholder="Nội dung" name="content" required></textarea>

                        <button onclick="saveDynamicDataToFile();" class="btn btn-primary send-button" id="submit" type="submit" value="SEND">
                           <div class="alt-send-button">
                              <i class="fa fa-paper-plane"></i><span class="send-text">SEND</span>
                           </div>

                        </button>
                        <!-- <center><button type="button" onclick="saveDynamicDataToFile();">Click to Save</button></center> -->
                     </form>

                     <center><button type="button" onclick="saveDynamicDataToFile();">Click to Save</button></center>
                  </div>
               </div>
               <div class="col-xs-6 col-md-4 gutter-sm-sm gutter-margin-xs-sm">
                  <div class="inner">

                     <h2>Mã code markdown</h2>
                     <hr>
                     <hr>
                     <div id="myText"></div>
                     <p>Ctrl+A và Ctrl+S để lưu code markdown. Bạn thử dùng Ctrl+V để dán nội dung đã copy vào file md
                        của bạn.</p>
                     <hr>


                  </div>
               </div>
            </div>
         </div>
      </section>
   </div>

</body>

<script src="../ckeditor5/build/ckeditor.js"></script>
<script src="../assets/js/FileSaver.js"></script>
<script>
   let titleId = "";
   function checkInputTitleId(obj) {
      if (obj && obj.value) {
         titleId = obj.value;
         console.log("title: ", titleId);
      }
   }
   let authorId = "";
   function checkInputAuthorId(obj) {
      if (obj && obj.value) {
         authorId = obj.value;
         console.log("authorId: ", authorId);
      }
   }

   let theEditor;
   ClassicEditor
      .create(document.querySelector('#editor')).then(editor => {
         console.log('Editor was initialized', editor);
         editor.model.document.on('change:data', () => {
            console.log(editor.getData());
            theEditor = editor.getData();
            document.getElementById('myText').innerHTML = "<pre>" + editor.getData() + "</pre>";
            // marked.parse(editor.getData());

         });
      })
      .catch(error => {
         console.error(error);
      });

   function saveDynamicDataToFile() {
      var userInput = document.getElementById("myText").value;
      var blob = new Blob([theEditor], { type: "text/plain;charset=utf-8" });
      saveAs(blob, "dynamic.txt");
   }

   function myFunction() {
      var copyText = document.getElementById("myText").innerHTML;
      window.prompt("Copy to clipboard: Ctrl+C, Enter", copyText);

      var tooltip = document.getElementById("myTooltip");
      tooltip.style.display = 'block';
      tooltip.innerHTML = "Đã copy";
   }
</script>


</html>
