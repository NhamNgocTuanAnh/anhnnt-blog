<html>

<head>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
   <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css'>
   <meta charset="utf-8">
   <title>Th√™m b√†i vi·∫øt m·ªõi v2</title>
   <link rel="icon" href="{{ site.baseurl }}/assets/images/logo.webp">
   <style>
      * {
         box-sizing: border-box;
      }

      body {
         background: #fff;
         margin: 0;
         padding: 0;
      }

      .image-wrap {
         background-image: url('../assets/images/nhiepanh/introduce/IMG_5756.webp');
         background-position: center;
         background-size: cover;
         height: 40rem;
         margin: 5rem auto;
         max-width: 60rem;
         position: relative;
         width: 100%;
      }

      .image-wrap .title {
         bottom: 0;
         color: #fff;
         left: 0;
         margin: 0;
         padding: 0;
         position: absolute;
      }

      .image-wrap .title::before {
         content: "";
         background-color: #fff;
         bottom: calc(100% + 2rem);
         height: 40rem;
         left: 0;
         position: absolute;
         width: 0.25rem;
      }

      .image-wrap .title::after {
         content: "";
         background-color: #fff;
         bottom: 0;
         height: 0.25rem;
         left: calc(100% + 2rem);
         position: absolute;
         width: 60rem;
      }

      .image-wrap h2 {
         color: #fff;
         display: block;
         font-family: Arial, sans-serif;
         font-size: calc(1.5rem + 1.5vw);
         font-weight: 800;
         letter-spacing: -0.15rem;
         line-height: 0.90;
         margin: 0;
         text-indent: -0.07em;
         text-transform: uppercase;
         white-space: nowrap;
      }

      .image-wrap .borders {
         bottom: 2rem;
         left: 2rem;
         overflow: hidden;
         position: absolute;
         right: 2rem;
         top: 2rem;
      }

      .image-wrap .borders::before {
         content: "";
         background-color: #fff;
         height: 0.25rem;
         left: 0;
         position: absolute;
         right: 0;
         top: 0;
      }

      .image-wrap .borders::after {
         content: "";
         background-color: #fff;
         bottom: 0;
         position: absolute;
         right: 0;
         top: 0;
         width: 0.25rem;
      }

      .image-wrap::before,
      .image-wrap::after {
         content: "";
         background: #777;
         bottom: 32px;
         box-shadow: 0 30px 20px rgba(0, 0, 0, 0.45);
         left: 8px;
         position: absolute;
         top: 80%;
         transform: rotate(-7deg);
         width: 50%;
         z-index: -1;
      }

      .image-wrap::after {
         left: auto;
         right: 8px;
         transform: rotate(7deg);
      }

   </style>
</head>

<body>
   <hr>
   <div>
      <section class="grid extended-grid-18">
         <div class="container clearfix">
            <div class="row row-sm-sm sample-row">
               <div class="col-xs-12 col-md-8 gutter-sm-sm gutter-margin-xs-sm">
                  <div class="inner">
                     <form id="contact-form" class="form-horizontal" role="form">

                        <div class="form-group">
                           <div class="col-sm-12">
                              <h4>Ti√™u ƒë·ªÅ</h4>
                              <input type="text" class="form-control" id="titleId" placeholder="Ti√™u ƒë·ªÅ"
                                 name="Ti√™u ƒë·ªÅ m∆°ÃÅi" value="" required>
                           </div>
                        </div>

                        <div class="form-group">
                           <div class="col-sm-12">
                              <h4>T√°c gi·∫£</h4>

                              <select id="authorId" name="author-name" class="form-control" required>
                                 <option value="john">Nh√¢m Ng·ªçc T·∫ßn</option>
                                 <option value="sal">Anh H√†ng X√≥m</option>
                                 <option value="minh">Qu·∫£ t√°o t√†u</option>
                              </select>
                           </div>
                        </div>
                        <div class="form-group">
                           <div class="col-sm-12">
                              <h4>ChuÃâ ƒë√™ÃÄ</h4>
                              <input type="text" class="form-control" id="categorieIds"
                                 placeholder="vd: nhi√™ÃÅp aÃânh, l√¢Ã£p triÃÄnh" name="category-name" value="" required>
                           </div>
                        </div>
                        <div class="form-group">
                           <div class="col-sm-12">
                              <h4>TheÃâ tag</h4>
                              <input type="text" class="form-control" id="tagIds"
                                 placeholder="vd: nhi√™ÃÅp aÃânh, l√¢Ã£p triÃÄnh" name="tag-name" value="" required>
                           </div>
                        </div>
                        <div class="form-group">
                           <div class="col-sm-12">
                              <h4>Ng√†y xu·∫•t b·∫£n</h4>
                              <input type="date" class="form-control" id="dateId" name="date-name" required>
                           </div>
                        </div>
                        <div class="form-group">
                           <div class="col-sm-12">
                              <h4>T√≥m t·∫Øt</h4>
                              <input type="text" class="form-control" value="" rows="10" placeholder="T√≥m t·∫Øt"
                                 name="description-name" id="descriptionId" required>
                           </div>
                        </div>
                        <div class="form-group">
                           <div class="col-sm-12">
                              <label for="myCheck">Cho pheÃÅp biÃÄnh lu√¢Ã£n:</label>
                              <input type="checkbox" id="myCheck" onclick="myFunction()">
                           </div>
                        </div>
                        <br>
                     </form>

                     <h4>N√¥Ã£i dung</h4>
                     <input id="editor" class="form-control" value="" rows="10" placeholder="N·ªôi dung" name="ck-name"
                        required>


                     <button onclick="saveDynamicDataToFile();" class="btn btn-primary send-button" id="submit"
                        type="submit" value="SEND">
                        <div class="alt-send-button">
                           <i class="fa fa-paper-plane"></i><span class="send-text">Click to Save</span>
                        </div>
                     </button>
                  </div>
               </div>
               <div class="col-xs-6 col-md-4 gutter-sm-sm gutter-margin-xs-sm">
                  <div class="inner">

                     <h2>M√£ code markdown</h2>
                     <hr>
                     <div class="js-copytextarea" id="myText"></div>
                     <button onclick="myFunctionCopy()">Copy text</button>
                     <p>B√¢ÃÅm Copy text ƒë·ªÉ l∆∞u code markdown. B·∫°n th·ª≠ d√πng Ctrl+V ƒë·ªÉ d√°n n·ªôi dung ƒë√£ copy v√†o file md
                        c·ªßa b·∫°n.</p>
                     <hr>
                     <b>L∆∞u yÃÅ:</b> Hi√™Ã£n taÃ£i upload aÃânh ch∆∞a hoaÃ£t ƒë√¥Ã£ng, baÃ£n coÃÅ th√™Ãâ cheÃÄn aÃânh theo hiÃÄnh m√¢ÃÉu
                     naÃÄy vaÃÄo n√¥Ã£i dung<br>
                     <script src="https://gist.github.com/NhamNgocTuanAnh/a3f249a8e318f92cd8a13ccd5bd4a3c5.js"></script>

                     <div class="image-wrap">
                        <div class="borders">
                           <div class="title">
                              <h2>ƒê√¢y laÃÄ<br>sampleüòÅ</h2>
                           </div>
                        </div>
                     </div>


                     Trong ƒëoÃÅ:
                     <ul>
                        <li>image_src: ƒë∆∞∆°ÃÄng d√¢ÃÉn cuÃâa aÃânh</li>
                        <li>image_alt: N√¥Ã£i dung aÃânh</li>
                        <li>image_title: Ti√™u ƒë√™ÃÄ cuÃâa aÃânh</li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </section>
   </div>

</body>

<script src="../ckeditor5/build/ckeditor.js"></script>
<script src="../assets/js/FileSaver.js"></script>
<script>

   let isComment = false;
   let titleValue = "";
   let authorValue = "";
   let categoryValue = "";
   let tagValue = "";
   let theEditor = "";
   let headContent = "";
   let dateValue = "";
   let descriptionValue = "";

   let dataResult = "";

   ClassicEditor
      .create(document.querySelector('#editor')).then(editor => {

         editor.model.document.on('change:data', () => {
            theEditor = editor.getData();
            if (headContent) {
               document.getElementById('myText').innerHTML = ["<pre>", headContent, editor.getData(), "</pre>"].join('');
            } else {
               document.getElementById('myText').innerHTML = ["<pre>", editor.getData(), "</pre>"].join('');
            }
         });
      })
      .catch(error => {
         console.error(error);
      });


   function checkChangeForm() {
      if (document.getElementById('titleId') && document.getElementById('titleId').value) {
         titleValue = document.getElementById('titleId').value
         titleValue = titleValue.trim()
      }
      if (document.getElementById('authorId') && document.getElementById('authorId').value) {
         authorValue = document.getElementById('authorId').value
         authorValue = authorValue.trim()
      }
      if (document.getElementById('categorieIds') && document.getElementById('categorieIds').value) {
         categoryValue = document.getElementById('categorieIds').value
         categoryValue = categoryValue.trim()
      }
      if (document.getElementById('tagIds') && document.getElementById('tagIds').value) {
         tagValue = document.getElementById('tagIds').value
         tagValue = tagValue.trim()
      }
      if (document.getElementById('dateId') && document.getElementById('dateId').value) {
         dateValue = (document.getElementById('dateId').value).toString()
      }
      if (document.getElementById('descriptionId') && document.getElementById('descriptionId').value) {
         descriptionValue = (document.getElementById('descriptionId').value).toString()
         descriptionValue = descriptionValue.trim()
      }

   }
   document.querySelector("form").addEventListener("change", (event) => {
      if (!event.target.classList.contains("nochange")) {
         console.log("fire change for me");
         checkChangeForm();
         headContent = "---\n"
         if (titleValue) {
            headContent = [headContent, "title: ", '"', titleValue, '"', "\n"].join('');
         }
         if (authorValue) {
            headContent = [headContent, "author: ", authorValue, "\n"].join('');
         }
         if (descriptionValue) {
            headContent = [headContent, "description: ", '"', descriptionValue, '"', "\n", "excerpt: ", '"', descriptionValue, '"', "\n"].join('');
            // excerpt
         }
         if (categoryValue) {
            headContent = [headContent, 'categories: ', '[ ', categoryValue, ' ]\n'].join('');
         }
         if (tagValue) {
            headContent = [headContent, 'tags: ', '[ ', tagValue, ' ]\n'].join('');
         }
         if (dateValue) {
            headContent = [headContent, 'date: ', '"', dateValue, '"', '\n'].join('');
         }
         headContent = [headContent, "lazyimages: ", '"', "enabled", '"', "\n", "layout: post\n", "isGithubComments: ", isComment, "\n", "---\n\n"].join('')
         if (headContent) {
            dataResult = ["<pre>", headContent, theEditor, "</pre>"].join('');
            document.getElementById('myText').innerHTML = dataResult;
         }
      } else {
         console.log("no change event for me");
      }
   });

   function checkInputCategoryIds(obj) {
      if (obj && obj.value) {
         categoryValue = obj.value;
         checkChangeForm();
      }
   }
   function checkInputTagIds(obj) {
      if (obj && obj.value) {
         tagValue = obj.value;
         checkChangeForm();
      }
   }
   function checkInputAuthorId(obj) {
      if (obj && obj.value) {
         authorValue = obj.value;
         checkChangeForm();
      }
   }
   function checkInputTitleId(obj) {
      if (obj && obj.value) {
         titleValue = obj.value;
         checkChangeForm();
      }
   }



   async function saveDynamicDataToFile() {
      if (headContent) {
         let nameFile = ""
         let blob = new Blob([[headContent, theEditor].join('')], { type: "text/plain;charset=utf-8" });

         if (!dateValue) {
            const d = new Date()
            let year = d.getFullYear();
            let month = d.getMonth() + 1;
            let day = d.getDate();
            dateValue = year + "-" + month + "-" + day
         }
         titleValue = titleValue.trim()
         titleValue = removeAccents(titleValue);
         titleValue = titleValue.replace(/\s/g, '-')
         titleValue = titleValue.toLowerCase()
         nameFile = dateValue + "-" + titleValue + ".md"
         saveAs(blob, nameFile);
      } else {
         alert('R·ªóng');
      }

   }


   function myFunction() {
      var checkBox = document.getElementById("myCheck");
      if (checkBox.checked == true) {
         isComment = true;
      } else {
         isComment = false;
      }
   }

   function myFunctionCopy() {
      if (headContent && theEditor) {
         navigator.clipboard.writeText([headContent, theEditor].join(''));
      }
   }
   function removeAccents(str) {
      var AccentsMap = [
         "a√†·∫£√£√°·∫°ƒÉ·∫±·∫≥·∫µ·∫Ø·∫∑√¢·∫ß·∫©·∫´·∫•·∫≠",
         "A√Ä·∫¢√É√Å·∫†ƒÇ·∫∞·∫≤·∫¥·∫Æ·∫∂√Ç·∫¶·∫®·∫™·∫§·∫¨",
         "dƒë", "Dƒê",
         "e√®·∫ª·∫Ω√©·∫π√™·ªÅ·ªÉ·ªÖ·∫ø·ªá",
         "E√à·∫∫·∫º√â·∫∏√ä·ªÄ·ªÇ·ªÑ·∫æ·ªÜ",
         "i√¨·ªâƒ©√≠·ªã",
         "I√å·ªàƒ®√ç·ªä",
         "o√≤·ªè√µ√≥·ªç√¥·ªì·ªï·ªó·ªë·ªô∆°·ªù·ªü·ª°·ªõ·ª£",
         "O√í·ªé√ï√ì·ªå√î·ªí·ªî·ªñ·ªê·ªò∆†·ªú·ªû·ª†·ªö·ª¢",
         "u√π·ªß≈©√∫·ª•∆∞·ª´·ª≠·ªØ·ª©·ª±",
         "U√ô·ª¶≈®√ö·ª§∆Ø·ª™·ª¨·ªÆ·ª®·ª∞",
         "y·ª≥·ª∑·ªπ√Ω·ªµ",
         "Y·ª≤·ª∂·ª∏√ù·ª¥"
      ];
      for (var i = 0; i < AccentsMap.length; i++) {
         var re = new RegExp('[' + AccentsMap[i].substr(1) + ']', 'g');
         var char = AccentsMap[i][0];
         str = str.replace(re, char);
      }
      return str;
   }
</script>


</html>
